Traceback (most recent call last):
  File "/Users/davidmoench/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/Users/davidmoench/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/Users/davidmoench/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
  File "/Users/davidmoench/.pyenv/versions/3.10.0/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/Users/davidmoench/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/Users/davidmoench/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/davidmoench/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# Initialize filter state
# Guess the position somewhat accurately, leave the velocity and acceleration state guesses as 0
x_0 = np.array([1, 2, 0, 0.1, 0, 0])
P_0 = np.eye(6) * 50 # Start with very low confidence in predictions

# Assume we can configure the system's process and measurement noise params correctly
Q = Q_true
R = R_true

xs, Ps = kalman_6d(zs, R, Q, x_0, P_0)
    
# Extract covariances for position, velocity, and acceleration
pos_vars, vel_vars, acc_vars = utils.separate_covar_series(Ps)
    
# Plot track, measurements, and estimate for position
fig, ax = plt.subplots(figsize=(10,6))
ax.plot(true_xs[:,0], true_xs[:,3], label=r'$\vec{x}$',  marker='o', markersize=2)
ax.plot(xs[:,0], xs[:,3], label=r'$\hat{x}$',  marker='o', markersize=2)
ax.plot(zs[:,0], zs[:,1], label=r'$\vec{z}$', marker='o', linestyle='none', markersize=2)
ax.set_title('Kalman position estimate')
ax.set_xlabel('x position')
ax.set_ylabel('y position')
ax.legend()
plt.show()
glue('mv_kf_pos', fig, display=False)

# Plot track, measurements, and estimate for pos, vel, acc in a tight figure
fig, ax = plt.subplots(nrows=1, ncols=3, figsize=(10,3.5))
ax[0].plot(true_xs[:,0], true_xs[:,3], label=r'$\vec{x}$',  marker='o', markersize=2)
ax[0].plot(xs[:,0], xs[:,3], label=r'$\hat{x}$',  marker='o', markersize=2)
ax[0].plot(zs[:,0], zs[:,1], label=r'$\vec{z}$', marker='o', linestyle='none', markersize=2)
ax[0].set_title('Kalman position estimate')
ax[0].set_xlabel('x position')
ax[0].set_ylabel('y position')
ax[0].legend()
ax[1].plot(true_xs[:,1], true_xs[:,4], label=r'$\vec{x}$',  marker='o', markersize=2)
ax[1].plot(xs[:,1], xs[:,4], label=r'$\hat{x}$',  marker='o', markersize=2)
ax[1].set_title('Kalman velocity estimate')
ax[1].set_xlabel('x velocity')
ax[1].set_ylabel('y velocity')
ax[1].legend()
ax[2].plot(true_xs[:,2], true_xs[:,5], label=r'$\vec{x}$',  marker='o', markersize=2)
ax[2].plot(xs[:,2], xs[:,5], label=r'$\hat{x}$',  marker='o', markersize=2)
ax[2].set_title('Kalman acceleration estimate')
ax[2].set_xlabel('x acceleration')
ax[2].set_ylabel('y acceleration')
ax[2].legend()
fig.tight_layout()
plt.show()
glue('mv_kf_pos_vel_acc', fig, display=False)

# Plot positional variance
fig, ax = plt.subplots(nrows=1, ncols=3, figsize=(10,3.5))
ax[0].plot(np.arange(0,N), pos_vars[:,0,0], label=r'$\sigma_x$')
ax[0].plot(np.arange(0,N), pos_vars[:,1,1], label=r'$\sigma_y$')
ax[0].set_title('Position estimate variances')
ax[0].set_xlabel('t')
ax[0].set_ylabel(r'$\sigma^2$')
ax[0].legend()
ax[1].plot(np.arange(0,N), vel_vars[:,0,0], label=r'$\sigma_{\dot{x}}$')
ax[1].plot(np.arange(0,N), vel_vars[:,1,1], label=r'$\sigma_{\dot{y}}$')
ax[1].set_title('Velocity estimate variance')
ax[1].set_xlabel('t')
ax[1].set_ylabel(r'$\sigma^2$')
ax[1].legend()
ax[2].plot(np.arange(0,N), acc_vars[:,0,0], label=r'$\sigma_{\ddot{x}}$')
ax[2].plot(np.arange(0,N), acc_vars[:,1,1], label=r'$\sigma_{\ddot{y}}$')
ax[2].set_title('Acceleration estimate variance')
ax[2].set_xlabel('t')
ax[2].set_ylabel(r'$\sigma^2$')
ax[2].legend()
fig.tight_layout()
plt.show()
glue('mv_kf_pva_variances', fig, display=False)

# TODO could plot x and y pos, vel, and acc as functions of t.
# TODO Plot x(t) and vel_x(t) slopes overlaid
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyboardInterrupt[0m                         Traceback (most recent call last)
Cell [0;32mIn[11], line 73[0m
[1;32m     71[0m ax[[38;5;241m2[39m][38;5;241m.[39mlegend()
[1;32m     72[0m fig[38;5;241m.[39mtight_layout()
[0;32m---> 73[0m [43mplt[49m[38;5;241;43m.[39;49m[43mshow[49m[43m([49m[43m)[49m
[1;32m     74[0m glue([38;5;124m'[39m[38;5;124mmv_kf_pva_variances[39m[38;5;124m'[39m, fig, display[38;5;241m=[39m[38;5;28;01mFalse[39;00m)
[1;32m     76[0m [38;5;66;03m# TODO could plot x and y pos, vel, and acc as functions of t.[39;00m
[1;32m     77[0m [38;5;66;03m# TODO Plot x(t) and vel_x(t) slopes overlaid[39;00m

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/pyplot.py:446[0m, in [0;36mshow[0;34m(*args, **kwargs)[0m
[1;32m    402[0m [38;5;250m[39m[38;5;124;03m"""[39;00m
[1;32m    403[0m [38;5;124;03mDisplay all open figures.[39;00m
[1;32m    404[0m 
[0;32m   (...)[0m
[1;32m    443[0m [38;5;124;03mexplicitly there.[39;00m
[1;32m    444[0m [38;5;124;03m"""[39;00m
[1;32m    445[0m _warn_if_gui_out_of_main_thread()
[0;32m--> 446[0m [38;5;28;01mreturn[39;00m [43m_get_backend_mod[49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[43mshow[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib_inline/backend_inline.py:90[0m, in [0;36mshow[0;34m(close, block)[0m
[1;32m     88[0m [38;5;28;01mtry[39;00m:
[1;32m     89[0m     [38;5;28;01mfor[39;00m figure_manager [38;5;129;01min[39;00m Gcf[38;5;241m.[39mget_all_fig_managers():
[0;32m---> 90[0m         [43mdisplay[49m[43m([49m
[1;32m     91[0m [43m            [49m[43mfigure_manager[49m[38;5;241;43m.[39;49m[43mcanvas[49m[38;5;241;43m.[39;49m[43mfigure[49m[43m,[49m
[1;32m     92[0m [43m            [49m[43mmetadata[49m[38;5;241;43m=[39;49m[43m_fetch_figure_metadata[49m[43m([49m[43mfigure_manager[49m[38;5;241;43m.[39;49m[43mcanvas[49m[38;5;241;43m.[39;49m[43mfigure[49m[43m)[49m
[1;32m     93[0m [43m        [49m[43m)[49m
[1;32m     94[0m [38;5;28;01mfinally[39;00m:
[1;32m     95[0m     show[38;5;241m.[39m_to_draw [38;5;241m=[39m []

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/IPython/core/display_functions.py:298[0m, in [0;36mdisplay[0;34m(include, exclude, metadata, transient, display_id, raw, clear, *objs, **kwargs)[0m
[1;32m    296[0m     publish_display_data(data[38;5;241m=[39mobj, metadata[38;5;241m=[39mmetadata, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[1;32m    297[0m [38;5;28;01melse[39;00m:
[0;32m--> 298[0m     format_dict, md_dict [38;5;241m=[39m [38;5;28;43mformat[39;49m[43m([49m[43mobj[49m[43m,[49m[43m [49m[43minclude[49m[38;5;241;43m=[39;49m[43minclude[49m[43m,[49m[43m [49m[43mexclude[49m[38;5;241;43m=[39;49m[43mexclude[49m[43m)[49m
[1;32m    299[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m format_dict:
[1;32m    300[0m         [38;5;66;03m# nothing to display (e.g. _ipython_display_ took over)[39;00m
[1;32m    301[0m         [38;5;28;01mcontinue[39;00m

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/IPython/core/formatters.py:179[0m, in [0;36mDisplayFormatter.format[0;34m(self, obj, include, exclude)[0m
[1;32m    177[0m md [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    178[0m [38;5;28;01mtry[39;00m:
[0;32m--> 179[0m     data [38;5;241m=[39m [43mformatter[49m[43m([49m[43mobj[49m[43m)[49m
[1;32m    180[0m [38;5;28;01mexcept[39;00m:
[1;32m    181[0m     [38;5;66;03m# FIXME: log the exception[39;00m
[1;32m    182[0m     [38;5;28;01mraise[39;00m

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/decorator.py:232[0m, in [0;36mdecorate.<locals>.fun[0;34m(*args, **kw)[0m
[1;32m    230[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m kwsyntax:
[1;32m    231[0m     args, kw [38;5;241m=[39m fix(args, kw, sig)
[0;32m--> 232[0m [38;5;28;01mreturn[39;00m [43mcaller[49m[43m([49m[43mfunc[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43m([49m[43mextras[49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[43margs[49m[43m)[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkw[49m[43m)[49m

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/IPython/core/formatters.py:223[0m, in [0;36mcatch_format_error[0;34m(method, self, *args, **kwargs)[0m
[1;32m    221[0m [38;5;250m[39m[38;5;124;03m"""show traceback on failed format call"""[39;00m
[1;32m    222[0m [38;5;28;01mtry[39;00m:
[0;32m--> 223[0m     r [38;5;241m=[39m [43mmethod[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    224[0m [38;5;28;01mexcept[39;00m [38;5;167;01mNotImplementedError[39;00m:
[1;32m    225[0m     [38;5;66;03m# don't warn on NotImplementedErrors[39;00m
[1;32m    226[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_check_return([38;5;28;01mNone[39;00m, args[[38;5;241m0[39m])

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/IPython/core/formatters.py:340[0m, in [0;36mBaseFormatter.__call__[0;34m(self, obj)[0m
[1;32m    338[0m     [38;5;28;01mpass[39;00m
[1;32m    339[0m [38;5;28;01melse[39;00m:
[0;32m--> 340[0m     [38;5;28;01mreturn[39;00m [43mprinter[49m[43m([49m[43mobj[49m[43m)[49m
[1;32m    341[0m [38;5;66;03m# Finally look for special method names[39;00m
[1;32m    342[0m method [38;5;241m=[39m get_real_method(obj, [38;5;28mself[39m[38;5;241m.[39mprint_method)

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/IPython/core/pylabtools.py:152[0m, in [0;36mprint_figure[0;34m(fig, fmt, bbox_inches, base64, **kwargs)[0m
[1;32m    149[0m     [38;5;28;01mfrom[39;00m [38;5;21;01mmatplotlib[39;00m[38;5;21;01m.[39;00m[38;5;21;01mbackend_bases[39;00m [38;5;28;01mimport[39;00m FigureCanvasBase
[1;32m    150[0m     FigureCanvasBase(fig)
[0;32m--> 152[0m [43mfig[49m[38;5;241;43m.[39;49m[43mcanvas[49m[38;5;241;43m.[39;49m[43mprint_figure[49m[43m([49m[43mbytes_io[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkw[49m[43m)[49m
[1;32m    153[0m data [38;5;241m=[39m bytes_io[38;5;241m.[39mgetvalue()
[1;32m    154[0m [38;5;28;01mif[39;00m fmt [38;5;241m==[39m [38;5;124m'[39m[38;5;124msvg[39m[38;5;124m'[39m:

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/backend_bases.py:2342[0m, in [0;36mFigureCanvasBase.print_figure[0;34m(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)[0m
[1;32m   2336[0m     renderer [38;5;241m=[39m _get_renderer(
[1;32m   2337[0m         [38;5;28mself[39m[38;5;241m.[39mfigure,
[1;32m   2338[0m         functools[38;5;241m.[39mpartial(
[1;32m   2339[0m             print_method, orientation[38;5;241m=[39morientation)
[1;32m   2340[0m     )
[1;32m   2341[0m     [38;5;28;01mwith[39;00m [38;5;28mgetattr[39m(renderer, [38;5;124m"[39m[38;5;124m_draw_disabled[39m[38;5;124m"[39m, nullcontext)():
[0;32m-> 2342[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mfigure[49m[38;5;241;43m.[39;49m[43mdraw[49m[43m([49m[43mrenderer[49m[43m)[49m
[1;32m   2344[0m [38;5;28;01mif[39;00m bbox_inches:
[1;32m   2345[0m     [38;5;28;01mif[39;00m bbox_inches [38;5;241m==[39m [38;5;124m"[39m[38;5;124mtight[39m[38;5;124m"[39m:

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/artist.py:95[0m, in [0;36m_finalize_rasterization.<locals>.draw_wrapper[0;34m(artist, renderer, *args, **kwargs)[0m
[1;32m     93[0m [38;5;129m@wraps[39m(draw)
[1;32m     94[0m [38;5;28;01mdef[39;00m [38;5;21mdraw_wrapper[39m(artist, renderer, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[0;32m---> 95[0m     result [38;5;241m=[39m [43mdraw[49m[43m([49m[43martist[49m[43m,[49m[43m [49m[43mrenderer[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     96[0m     [38;5;28;01mif[39;00m renderer[38;5;241m.[39m_rasterizing:
[1;32m     97[0m         renderer[38;5;241m.[39mstop_rasterizing()

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/artist.py:72[0m, in [0;36mallow_rasterization.<locals>.draw_wrapper[0;34m(artist, renderer)[0m
[1;32m     69[0m     [38;5;28;01mif[39;00m artist[38;5;241m.[39mget_agg_filter() [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m     70[0m         renderer[38;5;241m.[39mstart_filter()
[0;32m---> 72[0m     [38;5;28;01mreturn[39;00m [43mdraw[49m[43m([49m[43martist[49m[43m,[49m[43m [49m[43mrenderer[49m[43m)[49m
[1;32m     73[0m [38;5;28;01mfinally[39;00m:
[1;32m     74[0m     [38;5;28;01mif[39;00m artist[38;5;241m.[39mget_agg_filter() [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/figure.py:3175[0m, in [0;36mFigure.draw[0;34m(self, renderer)[0m
[1;32m   3172[0m         [38;5;66;03m# ValueError can occur when resizing a window.[39;00m
[1;32m   3174[0m [38;5;28mself[39m[38;5;241m.[39mpatch[38;5;241m.[39mdraw(renderer)
[0;32m-> 3175[0m [43mmimage[49m[38;5;241;43m.[39;49m[43m_draw_list_compositing_images[49m[43m([49m
[1;32m   3176[0m [43m    [49m[43mrenderer[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43martists[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msuppressComposite[49m[43m)[49m
[1;32m   3178[0m [38;5;28;01mfor[39;00m sfig [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39msubfigs:
[1;32m   3179[0m     sfig[38;5;241m.[39mdraw(renderer)

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/image.py:131[0m, in [0;36m_draw_list_compositing_images[0;34m(renderer, parent, artists, suppress_composite)[0m
[1;32m    129[0m [38;5;28;01mif[39;00m not_composite [38;5;129;01mor[39;00m [38;5;129;01mnot[39;00m has_images:
[1;32m    130[0m     [38;5;28;01mfor[39;00m a [38;5;129;01min[39;00m artists:
[0;32m--> 131[0m         [43ma[49m[38;5;241;43m.[39;49m[43mdraw[49m[43m([49m[43mrenderer[49m[43m)[49m
[1;32m    132[0m [38;5;28;01melse[39;00m:
[1;32m    133[0m     [38;5;66;03m# Composite any adjacent images together[39;00m
[1;32m    134[0m     image_group [38;5;241m=[39m []

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/artist.py:72[0m, in [0;36mallow_rasterization.<locals>.draw_wrapper[0;34m(artist, renderer)[0m
[1;32m     69[0m     [38;5;28;01mif[39;00m artist[38;5;241m.[39mget_agg_filter() [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m     70[0m         renderer[38;5;241m.[39mstart_filter()
[0;32m---> 72[0m     [38;5;28;01mreturn[39;00m [43mdraw[49m[43m([49m[43martist[49m[43m,[49m[43m [49m[43mrenderer[49m[43m)[49m
[1;32m     73[0m [38;5;28;01mfinally[39;00m:
[1;32m     74[0m     [38;5;28;01mif[39;00m artist[38;5;241m.[39mget_agg_filter() [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/axes/_base.py:3064[0m, in [0;36m_AxesBase.draw[0;34m(self, renderer)[0m
[1;32m   3061[0m [38;5;28;01mif[39;00m artists_rasterized:
[1;32m   3062[0m     _draw_rasterized([38;5;28mself[39m[38;5;241m.[39mfigure, artists_rasterized, renderer)
[0;32m-> 3064[0m [43mmimage[49m[38;5;241;43m.[39;49m[43m_draw_list_compositing_images[49m[43m([49m
[1;32m   3065[0m [43m    [49m[43mrenderer[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43martists[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mfigure[49m[38;5;241;43m.[39;49m[43msuppressComposite[49m[43m)[49m
[1;32m   3067[0m renderer[38;5;241m.[39mclose_group([38;5;124m'[39m[38;5;124maxes[39m[38;5;124m'[39m)
[1;32m   3068[0m [38;5;28mself[39m[38;5;241m.[39mstale [38;5;241m=[39m [38;5;28;01mFalse[39;00m

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/image.py:131[0m, in [0;36m_draw_list_compositing_images[0;34m(renderer, parent, artists, suppress_composite)[0m
[1;32m    129[0m [38;5;28;01mif[39;00m not_composite [38;5;129;01mor[39;00m [38;5;129;01mnot[39;00m has_images:
[1;32m    130[0m     [38;5;28;01mfor[39;00m a [38;5;129;01min[39;00m artists:
[0;32m--> 131[0m         [43ma[49m[38;5;241;43m.[39;49m[43mdraw[49m[43m([49m[43mrenderer[49m[43m)[49m
[1;32m    132[0m [38;5;28;01melse[39;00m:
[1;32m    133[0m     [38;5;66;03m# Composite any adjacent images together[39;00m
[1;32m    134[0m     image_group [38;5;241m=[39m []

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/artist.py:72[0m, in [0;36mallow_rasterization.<locals>.draw_wrapper[0;34m(artist, renderer)[0m
[1;32m     69[0m     [38;5;28;01mif[39;00m artist[38;5;241m.[39mget_agg_filter() [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m     70[0m         renderer[38;5;241m.[39mstart_filter()
[0;32m---> 72[0m     [38;5;28;01mreturn[39;00m [43mdraw[49m[43m([49m[43martist[49m[43m,[49m[43m [49m[43mrenderer[49m[43m)[49m
[1;32m     73[0m [38;5;28;01mfinally[39;00m:
[1;32m     74[0m     [38;5;28;01mif[39;00m artist[38;5;241m.[39mget_agg_filter() [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/legend.py:726[0m, in [0;36mLegend.draw[0;34m(self, renderer)[0m
[1;32m    722[0m     [38;5;28mself[39m[38;5;241m.[39m_legend_box[38;5;241m.[39mset_width([38;5;28mself[39m[38;5;241m.[39mget_bbox_to_anchor()[38;5;241m.[39mwidth [38;5;241m-[39m pad)
[1;32m    724[0m [38;5;66;03m# update the location and size of the legend. This needs to[39;00m
[1;32m    725[0m [38;5;66;03m# be done in any case to clip the figure right.[39;00m
[0;32m--> 726[0m bbox [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_legend_box[49m[38;5;241;43m.[39;49m[43mget_window_extent[49m[43m([49m[43mrenderer[49m[43m)[49m
[1;32m    727[0m [38;5;28mself[39m[38;5;241m.[39mlegendPatch[38;5;241m.[39mset_bounds(bbox[38;5;241m.[39mbounds)
[1;32m    728[0m [38;5;28mself[39m[38;5;241m.[39mlegendPatch[38;5;241m.[39mset_mutation_scale(fontsize)

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/offsetbox.py:402[0m, in [0;36mOffsetBox.get_window_extent[0;34m(self, renderer)[0m
[1;32m    400[0m bbox [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mget_bbox(renderer)
[1;32m    401[0m [38;5;28;01mtry[39;00m:  [38;5;66;03m# Some subclasses redefine get_offset to take no args.[39;00m
[0;32m--> 402[0m     px, py [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mget_offset[49m[43m([49m[43mbbox[49m[43m,[49m[43m [49m[43mrenderer[49m[43m)[49m
[1;32m    403[0m [38;5;28;01mexcept[39;00m [38;5;167;01mTypeError[39;00m:
[1;32m    404[0m     px, py [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mget_offset()

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/offsetbox.py:60[0m, in [0;36m_compat_get_offset.<locals>.get_offset[0;34m(self, *args, **kwargs)[0m
[1;32m     56[0m params [38;5;241m=[39m _api[38;5;241m.[39mselect_matching_signature(sigs, [38;5;28mself[39m, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[1;32m     57[0m bbox [38;5;241m=[39m (params[[38;5;124m"[39m[38;5;124mbbox[39m[38;5;124m"[39m] [38;5;28;01mif[39;00m [38;5;124m"[39m[38;5;124mbbox[39m[38;5;124m"[39m [38;5;129;01min[39;00m params [38;5;28;01melse[39;00m
[1;32m     58[0m         Bbox[38;5;241m.[39mfrom_bounds([38;5;241m-[39mparams[[38;5;124m"[39m[38;5;124mxdescent[39m[38;5;124m"[39m], [38;5;241m-[39mparams[[38;5;124m"[39m[38;5;124mydescent[39m[38;5;124m"[39m],
[1;32m     59[0m                          params[[38;5;124m"[39m[38;5;124mwidth[39m[38;5;124m"[39m], params[[38;5;124m"[39m[38;5;124mheight[39m[38;5;124m"[39m]))
[0;32m---> 60[0m [38;5;28;01mreturn[39;00m [43mmeth[49m[43m([49m[43mparams[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mself[39;49m[38;5;124;43m"[39;49m[43m][49m[43m,[49m[43m [49m[43mbbox[49m[43m,[49m[43m [49m[43mparams[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mrenderer[39;49m[38;5;124;43m"[39;49m[43m][49m[43m)[49m

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/offsetbox.py:313[0m, in [0;36mOffsetBox.get_offset[0;34m(self, bbox, renderer)[0m
[1;32m    298[0m [38;5;129m@_compat_get_offset[39m
[1;32m    299[0m [38;5;28;01mdef[39;00m [38;5;21mget_offset[39m([38;5;28mself[39m, bbox, renderer):
[1;32m    300[0m [38;5;250m    [39m[38;5;124;03m"""[39;00m
[1;32m    301[0m [38;5;124;03m    Return the offset as a tuple (x, y).[39;00m
[1;32m    302[0m 
[0;32m   (...)[0m
[1;32m    310[0m [38;5;124;03m    renderer : `.RendererBase` subclass[39;00m
[1;32m    311[0m [38;5;124;03m    """[39;00m
[1;32m    312[0m     [38;5;28;01mreturn[39;00m (
[0;32m--> 313[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_offset[49m[43m([49m[43mbbox[49m[38;5;241;43m.[39;49m[43mwidth[49m[43m,[49m[43m [49m[43mbbox[49m[38;5;241;43m.[39;49m[43mheight[49m[43m,[49m[43m [49m[38;5;241;43m-[39;49m[43mbbox[49m[38;5;241;43m.[39;49m[43mx0[49m[43m,[49m[43m [49m[38;5;241;43m-[39;49m[43mbbox[49m[38;5;241;43m.[39;49m[43my0[49m[43m,[49m[43m [49m[43mrenderer[49m[43m)[49m
[1;32m    314[0m         [38;5;28;01mif[39;00m [38;5;28mcallable[39m([38;5;28mself[39m[38;5;241m.[39m_offset)
[1;32m    315[0m         [38;5;28;01melse[39;00m [38;5;28mself[39m[38;5;241m.[39m_offset)

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/legend.py:695[0m, in [0;36mLegend._findoffset[0;34m(self, width, height, xdescent, ydescent, renderer)[0m
[1;32m    692[0m [38;5;250m[39m[38;5;124;03m"""Helper function to locate the legend."""[39;00m
[1;32m    694[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39m_loc [38;5;241m==[39m [38;5;241m0[39m:  [38;5;66;03m# "best".[39;00m
[0;32m--> 695[0m     x, y [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_find_best_position[49m[43m([49m[43mwidth[49m[43m,[49m[43m [49m[43mheight[49m[43m,[49m[43m [49m[43mrenderer[49m[43m)[49m
[1;32m    696[0m [38;5;28;01melif[39;00m [38;5;28mself[39m[38;5;241m.[39m_loc [38;5;129;01min[39;00m Legend[38;5;241m.[39mcodes[38;5;241m.[39mvalues():  [38;5;66;03m# Fixed location.[39;00m
[1;32m    697[0m     bbox [38;5;241m=[39m Bbox[38;5;241m.[39mfrom_bounds([38;5;241m0[39m, [38;5;241m0[39m, width, height)

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/legend.py:1140[0m, in [0;36mLegend._find_best_position[0;34m(self, width, height, renderer, consider)[0m
[1;32m   1137[0m badness [38;5;241m=[39m [38;5;241m0[39m
[1;32m   1138[0m [38;5;66;03m# XXX TODO: If markers are present, it would be good to take them[39;00m
[1;32m   1139[0m [38;5;66;03m# into account when checking vertex overlaps in the next line.[39;00m
[0;32m-> 1140[0m badness [38;5;241m=[39m ([38;5;28;43msum[39;49m[43m([49m[43mlegendBox[49m[38;5;241;43m.[39;49m[43mcount_contains[49m[43m([49m[43mline[49m[38;5;241;43m.[39;49m[43mvertices[49m[43m)[49m
[1;32m   1141[0m [43m               [49m[38;5;28;43;01mfor[39;49;00m[43m [49m[43mline[49m[43m [49m[38;5;129;43;01min[39;49;00m[43m [49m[43mlines[49m[43m)[49m
[1;32m   1142[0m            [38;5;241m+[39m legendBox[38;5;241m.[39mcount_contains(offsets)
[1;32m   1143[0m            [38;5;241m+[39m legendBox[38;5;241m.[39mcount_overlaps(bboxes)
[1;32m   1144[0m            [38;5;241m+[39m [38;5;28msum[39m(line[38;5;241m.[39mintersects_bbox(legendBox, filled[38;5;241m=[39m[38;5;28;01mFalse[39;00m)
[1;32m   1145[0m                  [38;5;28;01mfor[39;00m line [38;5;129;01min[39;00m lines))
[1;32m   1146[0m [38;5;28;01mif[39;00m badness [38;5;241m==[39m [38;5;241m0[39m:
[1;32m   1147[0m     [38;5;28;01mreturn[39;00m l, b

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/legend.py:1140[0m, in [0;36m<genexpr>[0;34m(.0)[0m
[1;32m   1137[0m badness [38;5;241m=[39m [38;5;241m0[39m
[1;32m   1138[0m [38;5;66;03m# XXX TODO: If markers are present, it would be good to take them[39;00m
[1;32m   1139[0m [38;5;66;03m# into account when checking vertex overlaps in the next line.[39;00m
[0;32m-> 1140[0m badness [38;5;241m=[39m ([38;5;28msum[39m([43mlegendBox[49m[38;5;241;43m.[39;49m[43mcount_contains[49m[43m([49m[43mline[49m[38;5;241;43m.[39;49m[43mvertices[49m[43m)[49m
[1;32m   1141[0m                [38;5;28;01mfor[39;00m line [38;5;129;01min[39;00m lines)
[1;32m   1142[0m            [38;5;241m+[39m legendBox[38;5;241m.[39mcount_contains(offsets)
[1;32m   1143[0m            [38;5;241m+[39m legendBox[38;5;241m.[39mcount_overlaps(bboxes)
[1;32m   1144[0m            [38;5;241m+[39m [38;5;28msum[39m(line[38;5;241m.[39mintersects_bbox(legendBox, filled[38;5;241m=[39m[38;5;28;01mFalse[39;00m)
[1;32m   1145[0m                  [38;5;28;01mfor[39;00m line [38;5;129;01min[39;00m lines))
[1;32m   1146[0m [38;5;28;01mif[39;00m badness [38;5;241m==[39m [38;5;241m0[39m:
[1;32m   1147[0m     [38;5;28;01mreturn[39;00m l, b

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/transforms.py:594[0m, in [0;36mBboxBase.count_contains[0;34m(self, vertices)[0m
[1;32m    591[0m vertices [38;5;241m=[39m np[38;5;241m.[39masarray(vertices)
[1;32m    592[0m [38;5;28;01mwith[39;00m np[38;5;241m.[39merrstate(invalid[38;5;241m=[39m[38;5;124m'[39m[38;5;124mignore[39m[38;5;124m'[39m):
[1;32m    593[0m     [38;5;28;01mreturn[39;00m ((([38;5;28mself[39m[38;5;241m.[39mmin [38;5;241m<[39m vertices) [38;5;241m&[39m
[0;32m--> 594[0m              (vertices [38;5;241m<[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmax[49m))[38;5;241m.[39mall(axis[38;5;241m=[39m[38;5;241m1[39m)[38;5;241m.[39msum())

File [0;32m~/.local/share/virtualenvs/jupyterbook-eAO5T2Nm/lib/python3.10/site-packages/matplotlib/transforms.py:338[0m, in [0;36mBboxBase.max[0;34m(self)[0m
[1;32m    335[0m [38;5;250m    [39m[38;5;124;03m"""The bottom-left corner of the bounding box."""[39;00m
[1;32m    336[0m     [38;5;28;01mreturn[39;00m np[38;5;241m.[39mmin([38;5;28mself[39m[38;5;241m.[39mget_points(), axis[38;5;241m=[39m[38;5;241m0[39m)
[0;32m--> 338[0m [38;5;129m@property[39m
[1;32m    339[0m [38;5;28;01mdef[39;00m [38;5;21mmax[39m([38;5;28mself[39m):
[1;32m    340[0m [38;5;250m    [39m[38;5;124;03m"""The top-right corner of the bounding box."""[39;00m
[1;32m    341[0m     [38;5;28;01mreturn[39;00m np[38;5;241m.[39mmax([38;5;28mself[39m[38;5;241m.[39mget_points(), axis[38;5;241m=[39m[38;5;241m0[39m)

[0;31mKeyboardInterrupt[0m: 

